<META name="description" content="ast-open package">
<META name="keywords" content="software, package">
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<META name="generator" content="mm2html (AT&T Labs Research) 2000-05-25">
<TITLE> ast-open package </TITLE>
</HEAD>
<BODY  marginheight=0 leftmargin=0 topmargin=0 marginwidth=0 bgcolor=white vlink=teal link=slateblue >
<TABLE border=0 width=640><TR><TD valign=top align=left>
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="ast-open package">ast-open package</A></H3></CENTER></FONT></FONT>
The AT&amp;T Labs Research ast-open package contains all of the ast open
source commands and libraries.
Components in this package:
<PRE>
    libast	probe	    tests	mam	    diff	libtk
    libcmd	libpp	    libcs	<A href="#msgcc">msgcc</A>	    <A href="#ie">ie</A>		<A href="#tksh">tksh</A>
    libdll	<A href="#proto">proto</A>	    <A href="#3d">3d</A>		<A href="#nmake">nmake</A>	    mailx	<A href="#tw">tw</A>
    <A href="#ksh93">ksh93</A>	libbz	    libcoshell	ss	    ncsl	<A href="#warp">warp</A>
    libodelta	bzip	    <A href="#coshell">coshell</A>	<A href="#at">at</A>	    pack
    libvdelta	libexpr	    cpp		<A href="#builtin">builtin</A>	    <A href="#pzip">pzip</A>
    libsum	librecsort  cs		libpz	    re
    <A href="#pax">pax</A>		libuu	    gmake	libcdb	    <A href="#sort">sort</A>
    html	libz	    libmam	cql	    <A href="#std">std</A>
</PRE>
<P>
This package is a superset of the following packages: ast-base ast-ksh; you won't need these if you download ast-open.
The software is covered by these licenses:
<UL type=square>
<LI>
<A href="http://www.research.att.com/sw/license/ast-open.html">http://www.research.att.com/sw/license/ast-open.html</A>
<LI>
<A href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</A>
</UL>
A recent
<A href="#release change log">release change log</A>
is also included.
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="ksh93">ksh93</A></H3></CENTER></FONT></FONT>
KSH-93 is the most recent version of the KornShell Language
described in
"The KornShell Command and Programming Language,"
by Morris Bolsky and David Korn of AT&amp;T Bell Laboratories, ISBN 0-13-182700-6.
The KornShell is a shell programming language,
which is upward compatible with "sh" (the Bourne Shell),
and is intended to conform to the IEEE P1003.2/ISO 9945.2 Shell and
Utilities standard.
KSH-93 provides an enhanced programming environment in
addition to the major command-entry features of the BSD
shell "csh".  With KSH-93, medium-sized programming tasks can be
performed at shell-level without a significant loss in performance.
In addition, "sh" scripts can be run on KSH-93 without modification.
<P>
The code should conform to the IEEE POSIX 1003.1 standard and to the
proposed ANSI-C standard so that it should be portable to all
such systems.  Like the previous version, KSH-88,
it is designed to accept eight bit character sets
transparently, thereby making it internationally compatible.
It can support multi-byte characters sets with some characteristics
of the character set given at run time.
<P>
KSH-93 provides the following features, many of which were also inherent
in KSH-88:
<UL type=square>
<LI>
Enhanced Command Re-entry Capability:  The KSH-93 history
function records commands entered at any shell level and stores
them, up to a user-specified limit, even after you log off.
This allows you to re-enter long commands with a few keystrokes
- even those commands you entered yesterday.
The history file allows for eight bit characters in
commands and supports essentially unlimited size histories.
<LI>
In-line Editing: In "sh", the only way to fix mistyped
commands is to backspace or retype the line. KSH-93 allows you
to edit a command line using a choice of EMACS-TC or "vi"
functions.
You can use the in-line editors to complete filenames as
you type them.
You may also use this editing feature when entering
command lines from your history file.
A user can capture keystrokes and rebind keys to customize the
editing interface.
<LI>
Extended I/O Capabilities:  KSH-93 provides several I/O
capabilities not available in "sh", including the ability to:
<UL type=circle>
<LI>
specify a file descriptor for input and output
<LI>
start up and run co-processes
<LI>
produce a prompt at the terminal before a read
<LI>
easily format and interpret responses to a menu
<LI>
echo lines exactly as output without escape processing
<LI>
format output using printf formats.
<LI>
read and echo lines ending in "<NULL>\<NULL>".
</UL>
<LI>
Improved performance: KSH-93 executes many scripts faster
than the System V Bourne shell. A major reason for this is
that many of the standard utilities are built-in.
To reduce the time to initiate a command, KSH-93 allows
commands to be added as built-ins at run time
on systems that support dynamic loading such as System V Release 4.
<LI>
Arithmetic: KSH-93 allows you to do integer arithmetic in any
base from two to sixty-four.  You can also do double
precision floating point arithmetic.
Almost the complete set of C language operators are available
with the same syntax and precedence.
Arithmetic expressions can be used to as an argument expansion 
or as a separate command.
In addition there is an arithmetic for command that works
like the for statement in C.
<LI>
Arrays: KSH-93 supports both indexed and associative arrays.
The subscript for an indexed array is an arithmetic expression,
whereas, the subscript for an associative array is a string.
<LI>
Shell Functions and Aliases: Two mechanisms - functions and
aliases - can be used to assign a user-selected identifier to
an existing command or shell script.
Functions allow local variables and provide scoping
for exception handling.
Functions can be searched for and loaded on first reference the
way scripts are.
<LI>
Substring Capabilities:  KSH-93 allows you to create a
substring of any given string either by specifying the starting
offset and length, or by stripping off leading
or trailing substrings during parameter substitution.
You can also specify attributes, such as upper and lower case,
field width, and justification to shell variables.
<LI>
More pattern matching capabilities:  KSH-93 allows you to specify
extended regular expressions for file and string matches.
<LI>
KSH-93 uses a hierarchal name space for variables.
Compound variables can be defined and variables can
be passed by reference.  In addition, each variable
can have one or more disciplines associated with
it to intercept assignments and references.
<LI>
Improved debugging:  KSH-93 can generate line numbers on execution
traces.  Also, I/O redirections are now traced.
There is a DEBUG trap that gets evaluated after each command
so that errors can be localized.
<LI>
Job Control: On systems that support job control, including
System V Release 4, KSH-93
provides a job-control mechanism almost identical to that of
the BSD "csh", version 4.1.
This feature allows you
to stop and restart programs, and to move programs between the
foreground and the background.
<LI>
Added security:
KSH-93 can execute scripts which do not have read permission
and scripts which have the setuid and/or setgid set when
invoked by name, rather than as an argument to the shell.
It is possible to log or control the execution of setuid and/or
setgid scripts.
The noclobber option prevents you from accidentally erasing
a file by redirecting to an existing file.
<LI>
KSH-93 can be extended by adding built-in commands at run time.
In addition, KSH-93 can be used as a library that can
be embedded into an application to allow scripting.
</UL>
Documentation for KSH-93 consists of an "Introduction to KSH-93",
"Compatibility with the Bourne Shell" and a manual page and a
README file.  In addition, the "New KornShell Command and Programming
Language," book is available from Prentice Hall.

<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="pax">pax</A></H3></CENTER></FONT></FONT>
<STRONG>pax</STRONG>
is a POSIX 1003.2 conformant replacement for
<STRONG>tar</STRONG>
and
<STRONG>cpio</STRONG>
that handles most UNIX archive and tape formats.
<STRONG>pax</STRONG>
uses the
<EM>vdelta</EM>
algorithm to construct efficient delta archives that contain bytewise
changes from a given base archive. 
<STRONG>gzip</STRONG>
and
<STRONG>compress</STRONG>
archives are also handled on input and output.
<P>
To create a
<EM>vdelta</EM>
compressed base archive:
<PRE>
     tw | pax -w -f base -z -
</PRE>
To create a delta archive on the base above (record file changes only):
<PRE>
     tw | pax -w -f delta -z base
</PRE>
To read the delta archive:
<PRE>
     pax -r -f delta -z base
</PRE>
To create a delta archive from linux-1.2.0 to linux-1.2.5:
<PRE>
     pax -rf linux-1.2.5.tar.gz -wf 0-5.pax.gz -x gzip -z linux-1.2.0.tar.gz
</PRE>
To create the linux-1.2.5 archive:
<PRE>
     pax -rf 0-5.pax.gz -z linux-1.2.0.tar.gz -wf linux-1.2.5.tar.gz -x tar -x gzip
</PRE>
The
<STRONG>bax</STRONG>
script, shipped with
<STRONG>pax</STRONG>,
combines
<STRONG>tw</STRONG>
and
<STRONG>pax</STRONG>
for handy backup control.
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="proto">proto</A></H3></CENTER></FONT></FONT>
<STRONG>proto</STRONG>
converts ANSI C prototype constructs to constructs compatible
with K&amp;R C, ANSI C, and C++.
Only files with the line
<PRE>
     #pragma prototyped
</PRE>
in the first 64 lines are processed; other files are silently ignored.
This is how
<STRONG>advsoft</STRONG>
source is first shipped to foreign architectures.
Once
<STRONG>advsoft</STRONG>
is bootstrapped the
non-<STRONG>proto</STRONG>
source can be built using the
<STRONG>advsoft</STRONG>
tools.
<P>
<STRONG>proto</STRONG>
also converts in the other direction by providing
<EM>extern</EM>
prototypes for a collection of K&amp;R source files and by converting
K&amp;R source files in place.
K&amp;R to ANSI is not 100%, but is a good starting point for manual conversion.
<P>
<STRONG>proto</STRONG>
is token based (no C grammar); this allows it to convert 
before C preprocessing, and also allows
<STRONG>proto</STRONG>
to be inserted into
the standalone
<STRONG>cpp</STRONG>.
This is how
<STRONG>nmake</STRONG>
compiles ANSI C source with K&amp;R compilers.
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="3d">3d</A></H3></CENTER></FONT></FONT>
<STRONG>3d</STRONG>
is the historical name for
<EM>n</EM><STRONG>DFS</STRONG><EM>,</EM>
the multiple dimension file system.
It is implemented as a shared library that is preloaded
before any other shared library using the recently documented
(<EM>ahem</EM>)
<STRONG>LD_PRELOAD</STRONG>
or
<STRONG>_RLD_LIST</STRONG>
feature of the runtime linker.
<STRONG>3d</STRONG>
intercepts pathname system calls (and other calls if tracing is
turned on) and provides a logical namespace on top of the underlying
physical file system.
The shared library implementation currently works
only on
<EM>bsd.i386</EM>,
<EM>linux.i386</EM>,
<EM>osf.alpha</EM>,
<EM>sun4</EM>,
<EM>sol.*</EM>,
and
<EM>sgi.*</EM>.
<P>
<STRONG>3d</STRONG>
works in conjunction with
<STRONG>ksh88</STRONG>
or
<STRONG>ksh93</STRONG>.
The
<STRONG>3d</STRONG>
command with no arguments enters a
<STRONG>3d</STRONG>
shell.
The
<STRONG>vpath</STRONG>
builtin controls the logical
filesystem view:
<PRE>
     vpath dir_1 dir_2
</PRE>
mounts the directory hierarchy
<EM>dir_1</EM>
on top of
<EM>dir_2</EM>.
Files under
<EM>dir_1</EM>
overlay files under
<EM>dir_2</EM>.
Files under
<EM>dir_2</EM>
are readonly;
any files under
<EM>dir_2</EM>
that are modified are first copied to the
corresponding place in
<EM>dir_1</EM>.
<EM>vpaths</EM>
may be chained:
<PRE>
     vpath dir_2 dir_3
</PRE>
<EM>vpaths</EM>
are per-process; every process may have a different view.
<EM>vpaths</EM>
are a handy way to separate source and generated files.
Typical
<STRONG>advsoft</STRONG>
users set up
<STRONG>3d</STRONG>
at login or
<STRONG>xterm</STRONG>
time:
<PRE>
     export HOSTTYPE=$(package)
     vpath $HOME/arch/$HOSTTYPE $HOME
</PRE>
with source files in
<TT>$HOME/src/(cmd|lib)/*</TT>.
<STRONG>nmake</STRONG>
is run in
<TT>$HOME/arch/$HOSTTYPE/src/(cmd|lib)/*</TT>
and generated files (objects and executables) are dropped in the top hierarchy.
<P>
<STRONG>2d</STRONG>
can prefix any command to disable 
<STRONG>3d</STRONG>
for that command:
<PRE>
     2d ls *.c
</PRE>
<P>
<STRONG>3d</STRONG>
also provides tracing, monitoring and call intercept services.
<STRONG>vpm</STRONG>
uses monitoring to graph the process and io hierarchy.
The
<EM>cs</EM>
name server uses pathname call intercepts to translate network
pathnames.
Try this for any host:
<PRE>
     cat /dev/tcp/hostname/inet.daytime
</PRE>
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="coshell">coshell</A></H3></CENTER></FONT></FONT>
<STRONG>coshell</STRONG>
executes blocks of shell commands on lightly loaded hosts in the local network.
There is one
<STRONG>coshell</STRONG>
server per user.
This server runs as a daemon on the user's home host,
and only processes running on the home host have access to the server.
The server controls a background
<STRONG>ksh</STRONG>
shell process, initiated by
<STRONG>rsh</STRONG>,
on each of the connected hosts.
<P>
<STRONG>coshell</STRONG>
is easy to use and administer.
The only privilege required for installation, administration or use is
<STRONG>rsh</STRONG>
access to the local hosts.
<STRONG>coshell</STRONG>
does requires a uniform file namespace across all hosts on the local network.
<P>
<STRONG>nmake</STRONG>
and
<STRONG>gmake</STRONG>
users can take advantage of network execution with
no makefile modifications.
Shell level access is similar to but more efficient than
<STRONG>rsh</STRONG>
and allows host expression matching to replace the explicit host name argument.
<P>
Factor of 5 compilation speedups are typical.
<P>
To start your local daemon:
<PRE>
     coshell +
</PRE>
To send
<STRONG>nmake</STRONG>
or
<STRONG>gmake</STRONG>
actions to
<STRONG>coshell</STRONG>
at concurrency level 8:
<PRE>
     export COSHELL=coshell
     export NPROC=8
</PRE>
To run shell commands on a lightly loaded host:
<PRE>
     coshell -r - 'hostname; sort a &gt; b' &amp;
     pid=$!
     # other stuff
     wait $pid
</PRE>
For interactive
<STRONG>coshell</STRONG>
status:
<PRE>
     coshell -
     coshell&gt; s
     <EM> ... status ...</EM>
     coshell&gt; h
     <EM> ... help ...</EM>
     coshell&gt; q
</PRE>
<STRONG>package</STRONG>
generates static host information and
<STRONG>ss</STRONG>
lists the dynamic status of hosts on the local network.
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="msgcc">msgcc</A></H3></CENTER></FONT></FONT>
<STRONG>msgcc</STRONG>
and
<STRONG>msgcpp</STRONG>
extract message text from C source for
<NOBR><A href="/~gsf/man/man1/gencat.html"><STRONG>gencat</STRONG></A>(1)</NOBR>
message catalogs.
<NOBR><A href="/~gsf/man/man1/msggen.html"><STRONG>msggen</STRONG></A>(1)</NOBR>
is a
<NOBR><A href="/~gsf/man/man1/gencat.html"><STRONG>gencat</STRONG></A>(1)</NOBR>
replacement that generates machine independent binary message
catalogs that are compatible with the
<STRONG>ast</STRONG>
<NOBR><A href="/~gsf/man/man3/catgets.html"><STRONG>catgets</STRONG></A>(3)</NOBR>
implementation.
<STRONG>catgets</STRONG>
also supports native message catalogs where available.
<NOBR><A href="/~gsf/man/man1/msgcvt.html"><STRONG>msgcvt</STRONG></A>(1)</NOBR>
and
<NOBR><A href="/~gsf/man/man1/msgadmin.html"><STRONG>msgadmin</STRONG></A>(1)</NOBR>
are administrative commands that support machine translation
of C locale message catalogs.
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="nmake">nmake</A></H3></CENTER></FONT></FONT>
<STRONG>nmake</STRONG>
is the AT&amp;T
<STRONG>nmake</STRONG>,
first released in 1985.
<STRONG>nmake</STRONG>
is a modern variant of the traditional Feldman
<STRONG>make</STRONG>
with an important difference:
<STRONG>nmake</STRONG>
maintains state that records
information for future runs.
The state includes:
<UL type=square>
<LI>
file modification times
<LI>
explicit prerequisites (from makefile assertions)
<LI>
implicit prerequisites (from
<EM>#include</EM>
scanning)
<LI>
action text (used to build targets)
<LI>
variable values
<LI>
target attributes
</UL>
State
<EM>and</EM>
a language to manipulate it finally makes concise
makefiles a reality; concise because rules traditionally placed in
each makefile can now be implemented in a general way in a single
<EM>base rules</EM>
file.
The base rules are such a fundamental part of
<STRONG>nmake</STRONG>
that most of its visible features are controlled by them.
<P>
Most makefiles are just a few lines:
<PRE>
     :PACKAGE: X11
     
     xgame :: README xgame.6 xgame.h xgame.c xutil.c -lXaw -lXmu -lXt
</PRE>
Automatically generated
<STRONG>probe</STRONG>
information provides convenient compiler abstractions:
<PRE>
     CCFLAGS = $(CC.PIC)
     
     ast 4.0 :LIBRARY: ast.c strmatch.c
</PRE>
In this case if the compiler supports
<EM>pic</EM>
(position independent code)
and shared libraries then
<TT>nmake install</TT>
will generate
<EM>libast.a</EM>
and
<EM>libast.so.4.0</EM>
(or the appropriate shared library suffix determined by
<STRONG>CC.SUFFIX.SHARED</STRONG>).
There are no
<STRONG>nmake</STRONG>
makefile generators (because the makefiles are so small),
there is no separate
<TT>make depend</TT>
(because the files with
<EM>.SCAN</EM>
attributes are automatically scanned for implicit prerequisites),
and there is no cheating (because all time stamp changes
are detected, not just
<EM>newer-than</EM>).
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="std">std</A></H3></CENTER></FONT></FONT>
The
<STRONG>ast</STRONG>
<STRONG>at</STRONG>
command is a re-implementations of
<NOBR><A href="/~gsf/man/man1/at.html"><STRONG>at</STRONG></A>(1)</NOBR>
and
<NOBR><A href="/~gsf/man/man1/crontab.html"><STRONG>crontab</STRONG></A>(1),</NOBR>
including a
<NOBR><A href="/~gsf/man/man1/cs.html"><STRONG>cs</STRONG></A>(1)</NOBR>
service \bat.svc\b for the \bat\b and \bcron\b daemons.
On most systems the
<STRONG>at</STRONG>
and
<STRONG>crontab</STRONG>
commands are installed as
<STRONG>ast_at</STRONG>
and
<STRONG>ast_crontab</STRONG>
because the \bat\b service executor \b$INSTALLROOT/lib/at/jobs/atx\b must be
installed setuid \broot\b so the daemon can operate multi-user
(enabling \broot\b privelege is always a manual operation with
<NOBR><A href="/~gsf/man/man1/package.html"><STRONG>package</STRONG></A>(1)</NOBR>
packages.)
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="builtin">builtin</A></H3></CENTER></FONT></FONT>
The
<STRONG>ast</STRONG>
<STRONG>builtin</STRONG>
commands are stand-alone implementations of the section
<STRONG>1</STRONG>
command in
<NOBR><A href="/~gsf/man/man3/libcmd.html"><STRONG>libcmd</STRONG></A>(3).</NOBR>
See the
<NOBR><A href="/~gsf/man/man1/ksh.html"><STRONG>ksh</STRONG></A>(1)</NOBR>
<STRONG>builtin</STRONG>(1)
command for information on loading command DLLs at runtime.
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="ie">ie</A></H3></CENTER></FONT></FONT>
<STRONG>ie</STRONG>
executes a dynamically linked command with the
<NOBR><A href="/~gsf/man/man1/ksh.html"><STRONG>ksh</STRONG></A>(1)</NOBR>
input line edit discipline pushed on the standard input.
All child processes will also have input line editing enabled.
<P>
<STRONG>ie</STRONG>
intercepts the
<NOBR><A href="/~gsf/man/man3/read.html"><STRONG>read</STRONG></A>(3)</NOBR>
system call by preloading a DLL (shared library) at runtime,
so it only works on architectures that support DLL preload.
Statically-linked, set-uid or set-gid commands will not work with
<STRONG>ie</STRONG>.
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="pzip">pzip</A></H3></CENTER></FONT></FONT>
Fixed length record data is often viewed as a waste of space,
too sparse for production use.
Much effort is then put into optimizing
the data schema, and in the process complicating the data interface.
<STRONG>pzip</STRONG>
shows that in many cases this view of fixed length data is wrong.
In fact, variable length data may become more compressible when
converted to a sparse, fixed length format.
Intense semantic schema
analysis can be replaced by an automated record partition, resulting in
compression space improvements of 2 to 10 times and decompression speed
improvements of 2 to 3 times over
<STRONG>gzip</STRONG>
for a large class of data.
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="sort">sort</A></H3></CENTER></FONT></FONT>
<STRONG>sort</STRONG>
is a POSIX 1003.2 conformant implementation based on
<STRONG>-lrecsort</STRONG>
by Phong Vo and Glenn Fowler with key encoding by Doug McIlroy.
The
<STRONG>recsort</STRONG>
discipline/method interface allows
<STRONG>sort</STRONG>
to double as a test harness for different sort algorithms.
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="std">std</A></H3></CENTER></FONT></FONT>
The
<STRONG>ast</STRONG>
<STRONG>std</STRONG>
commands are re-implementations of some of the standard section
<STRONG>1</STRONG>
commands.
On most systems the
<STRONG>mount</STRONG>
and
<STRONG>ps</STRONG>
commands are installed as
<STRONG>ast_mount</STRONG>
and
<STRONG>ast_ps</STRONG>
because the author either could not keep up with option proliferation or
the commands must be installed with sufficient privelege to operate
multi-user.
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="tksh">tksh</A></H3></CENTER></FONT></FONT>
<EM>tksh</EM>
is an implementation of the Tcl C library
written on top of the library for the new KornShell
(<EM>ksh93</EM>).
<EM>tksh</EM>
emulates the behavior of Tcl by using the API that is provided for extending
<EM>ksh93</EM>,
which is similar to the Tcl library in that it allows access to
variables, functions and other state of the interpreter.
This implementation requires no modification to
<EM>ksh93</EM>,
and allows Tcl libraries such as Tk to run on top of
<EM>ksh93</EM>
unchanged,
making it possible to use shell scripts in
place of Tcl scripts. 
<EM>ksh93</EM>
is well suited for use with Tk because it is
backward compatible with
<EM>sh</EM>,
making it both easy to learn and easy to extend
existing scripts to provide a graphical user interface.
<P>
<EM>tksh</EM>
is not yet
another port of Tk to another language -- it allows Tcl scripts to run without
modification using the ksh93 internals.
This makes it possible to combine
Tcl and
<EM>ksh93</EM>,
which is useful for writing
<EM>ksh93</EM>
scripts that use components that have been implemented in Tcl
(such as Tk widgets).
<P>
<EM>tksh</EM>
was developed by
<A href="http://www.research.att.com/~jlk" target=_top>Jeff Korn</A>
and is distributed by
<A href="mailto:advsoft@research.att.com" target=_top>advsoft@research.att.com</A>.
For the latest information vist the
<EM>tksh</EM>
<A href="http://www.cs.princeton.edu/~jlk/tksh" target=_top>home page</A>.
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="tw">tw</A></H3></CENTER></FONT></FONT>
<STRONG>tw</STRONG>
is a combination of
<STRONG>find</STRONG>
and
<STRONG>xargs</STRONG>
that applies C style expressions on the
<EM>stat</EM>
structure of each file in a directory hierarchy.
<PRE>
     tw
</PRE>
lists the directory hierarchy under the current directory,
<PRE>
     tw chmod go-rwx
</PRE>
changes the mode of all files in the directory hierarchy under the current
directory by calling
<STRONG>chmod</STRONG>
as few times as the
<EM>exec</EM>
arg limit allows.
<PRE>
     tw -d /usr/src -e "name=='*.&#0091;chly&#0093;'" grep FOOBAR
</PRE>
greps for
<STRONG>FOOBAR</STRONG>
in all the
<STRONG>C</STRONG>
source files in /usr/src. 
<P>
<STRONG>tw</STRONG>
efficiently prunes the file tree search; it follows symbolic
links by default (logical walk).
The
<STRONG>getconf</STRONG>
variable
<STRONG>PATH_RESOLVE</STRONG>
controls the default behavior for all
<STRONG>advsoft</STRONG>
commands:
<PRE>
     getconf PATH_RESOLVE - physical
</PRE>
sets the default to not follow symbolic links,
<STRONG>logical</STRONG>
to follow,
and
<STRONG>metaphysical</STRONG>
to follow only command line symbolic links
(corresponding to the -P, -L and -H command options that override the
default).
<PRE>
     tw -P -e type==LNK
</PRE>
does a physical walk that lists all symbolic links.
<PRE>
     tw -e "mtime&gt;='yesterday morning'"
</PRE>
lists all files modified since yesterday morning.
The magic file types from the
<STRONG>file</STRONG>
command are available in
<STRONG>tw</STRONG>
expressions
(<STRONG>tw</STRONG>
and
<STRONG>file</STRONG>
use the same library routine in
<STRONG>libast</STRONG>):
<PRE>
     tw -e "(mode &amp; 'u+s') &amp;&amp; magic == '*script*'" chmod u-s
</PRE>
finds all setuid scripts and turns off the setuid mode bit.
The magic file also contains MIME types:
<PRE>
     tw -e "mime == '*/exe'"
</PRE>
lists all executable programs
(<EM>a.out</EM>'s).
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="warp">warp</A></H3></CENTER></FONT></FONT>
<STRONG>warp</STRONG>
executes a dynamically linked command in a different time frame.
It intercepts time related system calls and modifies the times seen by
the command using the formula:
<PRE>
     time' = time + warp + (time - base) * (factor - 1)
</PRE>
where:
<UL type=square>
<LI>
<EM>time'</EM>
The logical system time seen by the command process.
<LI>
<EM>time</EM>
The physical system time.
<LI>
<EM>warp</EM>
A fixed offset from the physical system time
(i.e., the warp.)
<LI>
<EM>base</EM>
The physical system time when
<STRONG>warp</STRONG>
was first applied to the process or any ancestor process.
<LI>
<EM>factor</EM>
The rate of logical time change with respect to the physical clock
(i.e., the warp factor.)
</UL>
<EM>warp</EM>,
<EM>base</EM>,
and
<EM>factor</EM>
are inherited by children of warped processes so that a child process
is warped in the same time frame as its parent.
Time progresses for warped processes at the rate of
<EM>factor</EM>
times the physical system clock.
Any files created by a warped process
will appear to be in the warped logical time frame
for that process but will appear in physical system time frame
for non-warped processes.
<P>
Statically-linked, set-uid or set-gid commands are not warped.
<H4>Interface</H4>
<STRONG>warp</STRONG>
&#0091;
<STRONG>&#45;b</STRONG>
<EM>base</EM>
&#0093; &#0091;
<STRONG>&#45;f</STRONG>
<EM>factor</EM>
&#0093; &#0091;
<STRONG>&#45;n</STRONG>
&#0093; &#0091;
<STRONG>&#45;t</STRONG>
&#0093;
<EM>date</EM>
&#0091;
<EM>command</EM>
&#0091;
<EM>arg</EM>
<NULL>...
&#0093; &#0093;
<P>
The components of the warp formula are set as follows:
the warp offset
<EM>warp</EM>
is
<EM>date-now</EM>,
<EM>base</EM>
is
<EM>date</EM>
by default,
and
<EM>factor</EM>
is 1 by default.
<P>
Command argument date specifications support common conventions:
<PRE>
     yesterday
     next week
     50 days
     2000-02-28/00:00
     feb 28 2000
</PRE>
Absolute seconds since the epoch, a.k.a.
<STRONG>time_t</STRONG>
values, are represented by
<STRONG>#</STRONG><EM>seconds.</EM>
<P>
The
<STRONG>&#45;n</STRONG>
option shows how
<EM>command</EM>
would be executed without actually executing it.
The
<STRONG>&#45;t</STRONG>
option traces each intercepted system call.
<P>
<STRONG>warp</STRONG>
executes
<EM>command</EM>
with optional
<EM>args</EM>,
or
<STRONG>$SHELL</STRONG>
if
<EM>command</EM>
is omitted.
<H4>Examples</H4>
<PRE>
     $ date -f %Y-%m-%d/%H:%M
     1998-03-11/13:41
     $ warp 2000-02-29/12:30:30 date -f %Y-%m-%d/%H:%M
     2000-02-29/12:30
     $ date -f %Y-%m-%d/%H:%M
     1998-03-11/13:44
     $ warp +57060970 date
     2000-01-01/00:00
     
     # get a shell where 1 logical day passes for each physical second
     $ PS1='(warp) ' warp -f $(60*60*24) 2000-02-29/12:30:30
     (warp) date -f %Y-%m-%d/%H:%M
     2000-03-07/18:58
     (warp) sleep 1
     (warp) date -f %Y-%m-%d/%H:%M
     2000-03-19/18:58
</PRE>
<PRE>
<P><HR><FONT face=courier><FONT color=red><CENTER><H3><A name="release change log">release change log</A></H3></CENTER></FONT></FONT>

Changes since 2000-02-01 or the last release follow.

<H4>ksh93</H4>

00-05-09  --- Release ksh93j  ---
00-05-09  Modified command substitution to avoid using /tmp files when
          run on read-only file systems. 
00-04-17  Modified printf to handle '%..Xc' and '%..Xs' options where X
	  is not an alpha character.  Previous versions core dumped with this.
00-04-10  Changes to multibyte editing code were made to use standard
	  ISO C functions rather than methods devised before the standard.
00-04-09  Add %H options to printf to output strings with &lt;"'&amp;\t&gt; properly
	  converted for use in HTML and XML documents.
00-04-07  Modified getopts builtin to handle <.>..</.>< >in usage string</ >
	  by invoking specified function.
00-04-04  Added self generating man pages for bg, fc, fg, disown, jobs,
	  hist, let, ., and ulimit.
00-03-30  The apppend operator += has been added and can be used
	  for all assignments, strings, arrays, and compount variables.
00-03-30  Code was modified in several places to support automatic
	  generation of C locale dictionaries.
00-03-28  A bug in which the set and trap commands invoked with --name
	  type arguments would terminate the invoking script  has
	  been fixed.
00-03-27  A bug in which the library path variable was not updated  
	  correcly on some systems as described in the 'g' point
	  release has been fixed. 
00-03-07  printf now returns a non-zero exit status when one of
          its arguments cannot be converted to the given type. 
00-03-05  The return value and error message for a command that
          was found on the path but was not executable was set
          incorrectly.
00-03-05  A prototype for ioctl() was removed from the vi edit mode.


<H4>pax</H4>

00-06-01 pax: fix mime format size by dropping last \r
00-05-26 pax: astconf("CONFORMANCE",0,0)=="standard" inhibits some extensions
	 pax: check USTAR file and link name lengths
00-04-01 pax.tst: export TZ=EST5EDT; new tests should be UCT
00-03-11 pax: add encapsulated mime format read
	 pax: fix vdb block count
00-02-14 pax: fix hard link read that didn't apply -s edit
	 pax: logical|physical filter options

<H4>html</H4>

00-05-25 mm2html: add viewgraph outline and navigation
00-05-11 mm2html: add .vG viewgraph macros
00-03-04 htmlrefs: add &lt;LINK rel=dynamic&gt;
00-02-14 htmlrefs: add .htaccess and &lt;LINK&gt; checks
	 mm2html: add .xx ref=...
	 mm2html: use "..." tag attribute quote instead of '...'
	 mm2html: .BL =&gt; &lt;UL&gt; square circle disc
00-02-03 mm2html: fix -o nohtml.ident

<H4>tests</H4>

00-04-01 Makefile: add ../../lib/libast to .SOURCE for features/sfio
00-03-07 opt.tst: add printf +1 bug fix test
00-02-14 opt.tst: fix for "..." attribute quote
	 datey2k.dat: oops: %l fails for old (2000-02-29) NOW

<H4>3d</H4>

00-02-14 3d command long options (finally)

<H4>coshell</H4>

00-02-01 --- release 2.2 ---

<H4>cs</H4>

00-05-09 mbb: add (message bulletin board service)

<H4>msgcc</H4>

00-04-20 first release

<H4>nmake</H4>

00-06-20 makerules: mam_lib_* always checks lib/lib/* file
00-06-19 makerules: generate dll in lib.so/libNN.dll
00-06-01 main,state: a few _UWIN tweaks for W98 FAT
00-05-31 shquote: fix for `foo == bar'
00-05-26 option: fix scanargs() bug that skipped some targets before options
00-05-22 makerules: drop .ORIGINAL.ALL
00-05-11 makerules: add :PACKAGE: { a b } to pick first of a b (thanks Dr. ek)
00-05-01 makerules: add $(STDCAT) initialization
00-04-01 makerules: add skeleton=1 to mkdir virtual directories in 2d
	 makerules: add CATALOG and ERROR_CATALOG
00-03-17 make.probe: fix CC.NMEDIT to grab only external text symbols
	 makerules: add :NOOPTIMIZE:
	 makerules: allow N.Ntag :LIBRARY: versions (and dll.custom)
	 makerules: insert $(*FLAGS_DEFAULT) on *FLAGS
	 makerules: don't omit -L*/local/* even if in CC.STDLIB
	 parse.c: `unknown operator' now a warning
00-03-07 pkg-X11.mk: add -lXaw candidate required libraries
00-03-06 add probe.lcl check
00-02-14 --- release 4.0 ---
00-02-10 Makerules: add CC.DLLBIG, :PACKAGE_INIT:
	 Makerules: add .ARCHIVE.OMIT. to .ARCLEAN.LIST.
	 Makerules: adjust :PACKAGE: search for X11 =&gt; X
	 Makerules: add .COMMON.SAVE to .LIST.PACKAGE.* source actions
	 Makerules: fix setv PACKAGE dirs
	 Makerules: add $(PACKAGE_LOCAL) and package_local=arch cmd prefix
	 Makerules: apply %.X&gt;% for `f :: b.X'
	 state.c: add local skew test for touch(3) { utime(2) or utimes(2) }
	 make.c: don't apply metarule if lhs has dir and metarule doesn't
00-02-08 believe if state.believe&gt;0 and  view level &gt;= (state.believe-1)
	 pkg-X11.mk: add PACKAGE_X11_VERSION=6 for X11R6 installations
	 pkg-X11.mk: add -ldnet_stub for osf.alpha
	 Makerules: fix .REQUIRE.-l%

<H4>at</H4>

00-06-16 atd,atx: use base 36 instead of 64 in job names (now just lower case)
00-05-22 crontab: clarify crontab jobs w.r.t at(1)
00-05-09 atd: ": LABEL; command" sets job label to LABEL
	 atd: roll over log file to AT_LOG_FILE.old each month
00-03-14 at,atd: add at.allow and at.deny checks; tweak uwin verifcations

<H4>builtin</H4>

00-04-01 uuencode: umask 022 fior consistent header comparisons
00-02-14 fmt: move to libcmd

<H4>ie</H4>

00-02-14 ie: ie.sh script replaces ie fun
	 ie: convert configure/* =&gt; features(ielib|options.sh)

<H4>mailx</H4>

00-05-09 add cd,pwd,${PWD},${OLDPWD} with ${CDPATH} check
00-05-04 lex: flush stdout before prompt!
00-03-17 add -Qn to get status of n most recent messages
	 fix imap -NS unread count
	 loosen up headerbotch header checks
00-02-29 handle multiline SMTP responses

<H4>pzip</H4>

00-05-31 pin: --size does filter() to verify guess, 0 if wrong
00-02-11 pin: always have state.map, even with no freq filter

<H4>std</H4>

00-06-10 dd: add swap=op
00-05-24 ls: fix --kilobytes, add --block-size
00-05-11 df,ls,ps: unknown format id is fatal error
00-05-02 dd: use iconv() for from=x to=y conversions
00-04-01 ls.tst: export TZ=EST5EDT; new tests should be UCT
00-03-17 rm: add PATH_ATTRIBUTES 'l' check (no hard links to directories)
	 date: --elapsed accepts odd arg count
	 catmerge: add
00-03-09 df: add --format
	 date: add --elapsed
00-02-07 ls: -a and -A now mutually exclusive
	 shar: add $USAGE_LICENSE

<H4>tksh</H4>

00-02-10  --- Release 7.6 ---
00-02-10  Update README file
00-02-09  Deleted unreferenced vars, dropped tcl 7.5 compatibility,
	  added _PACKAGE_ast &lt;tm.h&gt; routines to tclUnixTime.c, added
	  forward refs to the Tcl_LinkVar() Tcl_UnlinkVar() tk callbacks,
	  changed Makefile library refs
00-02-07  Modified shcompat.c and shcompat.h to handle
          change to ksh93 where nvenv is now private.
00-02-07  Included Tk4.2 in distribution to avoid
          compatibility problems.  Modified Makefile.
00-02-07  Using new packaging provided by gsf 

<H4>tw</H4>

00-05-23 cmdarg: fix -a strchr loop (thanks dr ek)
00-05-01 find: add &#0091;f&#0093;printx and %&#0091;xX&#0093; -- or use tw
00-03-12 find: fix multiple PRINT with -print imbeded in ( ) -o ( )

<H4>libast</H4>

00-06-01 strmatch: initialize match.current.beg&#0091;0&#0093; to avoid dump at line 670
	 sfio/stdio: a few more errno tweaks
	 astquery: sfstdin/sfstderr by default
00-05-26 sfmode: errno=EBADF for invalid stream use
00-05-22 rewind: fix for xopen test
00-05-18 mcfind: returns absolute path
00-05-16 optget: --keys must catch <.>..</.>< >too</ >
	 translate,mc: errno cleanup
00-05-09 magic: add netbsd binary magic
	 fts: PATH_RESOLVE!=logical =&gt; FTS_SEEDOTDIR
	 ftwflags: call fts_flags()
	 astconf: astconf(0,0,0) re-syncs with _AST_FEATURES
00-05-08 optget: --usage &amp; --keys for last -catalog group only
00-05-02 iconv.c: add; use codes&#0091;&#0093; in ccmapid() and ccmapname(); "" for native
00-05-01 pathtmp: copy env values (libshell or putenv may change)
00-04-01 optget: drop bar from &#0091;-foo?bar&#0093; for --??keys
	 sfvscanf: add %X -- duh
	 features/common: fix va_listval() for power pc
	 findopen: fix FIND_GENERATE codes file search
	 magic: add ERROR_translate() and msgcat.key
	 tmlocale: add for LC_TIME locale info
	 tmlex: check tm_info.format and tm_data.format
	 tmfix: fix for tm_wday special case (via nl_langinfo on LC_TIME fields)
	 strftime: fix for nl_langinfo special case
	 ast_std.h: provide LC_* defauls if not defined
	 sfnew: check ${_AST_sfio_bufsize} -- don't tell kpv
	 catopen,nl_types.h: add intercept to mc* routines
	 magic.tab: add ast message catalog
	 strerror: add _ast_strerror intercept with ERROR_translate("errno")
	 fmtquote: escapes &gt;0177 only if (flags&amp;2)
00-03-17 feof: stdio macro functions only for _UWIN
	 optget: proper ERROR_translate() calls
	 astgetconf: add for thread safe error message control
	 astlicense: fix type=special but with non-null notice
	 errorx: add for ERROR_translate() support
	 ERROR_translate: add locale id args for alternate dictionary
	 option.h: move _OPT_PRIVATE_ to pointer to avoid dll size mismatch
	 ftwalk: fix FTW_CHILDREN bug that hit top level non-dirs twice
	 translate.c: default error_info.translate
	 astconf: fix dup loop thrash that never returns, add _AST_VERSION
00-03-10 ast_std.h: do _LARGEFILE_SOURCE initialization before std headers
	 fmtquote: handle $'...' quotes
00-03-07 optget: fix numeric option support test
	 sfkeyprintf: add %q for '...' quoting with ansi escapes
00-03-06 features/stdio: fix _sfflsbuf prototype (dingold@gte.net)
00-02-14 pathtmp: fix pid cache bug that sometimes repeated after ~10 attempts
	 optget: "..." attribute quote
	 pathfind: eliminate *: prefix in lib, not type
	 proc: PROC_FOREGROUND for system(3) semantics (wait status return)
	 pathtmp: fix mktemp() logic
	 fts: fix FTS_NOSEEDOTDIR bug that botched ./* in top list
	 include/ast/prototyped.h includes include/prototyped.h
	 pathpath: fix strdup(0) bug
	 optget: --html &lt;foo@bar&gt; =&gt; ...mailto:foo@bar...
	 sscanf: fix sfsscanf =&gt; sfvsscanf typo
	 magic.tab: strengthen tar recognition
00-02-08 conf.sh: fix ifdef for systems that think sysconf(FOO) is const
00-02-04 glob: fix globlist_t.gl_flags
00-02-02 vm*: add NoF() for data only files

<H4>libcmd</H4>

00-05-18 add setlocale(LC_ALL,"")
00-04-30 join: drop wierd opt_info.argv reference
00-03-17 expr: add == operator -- duh
	 cp,ln,mv: delay pathcanon() on destination to verify `cp a b/.'
	 getconf: use astgetconf for proper message control
	 ERROR_translate: dictionary update
00-03-08 tail: handle multiple -f files
00-03-07 fmt: add
00-03-07 dirname: handle PATH_LEADING_SLASHES as documented
	 tail: accept + options
00-02-14 chmod: --ignore-umask to ignore umask(2) in symbolic expressions
	 chmod,chgrp,cp: use FTS_NOSEEDOTDIR for correct path construction
	 cat: fix -n (was ignored, wow)

<H4>librecsort</H4>

00-03-17 rskey.c: consult RLIMIT_DATA for size limits

<H4>libuu</H4>

00-03-04 uulib: add posix decode size check

<H4>libcoshell</H4>

00-02-14 procrun,system: system(3) returns wait() status (not shell status)

<H4>libcs</H4>

00-06-01 csopen: handle dynamic ip assignment underfoot
00-05-11 csopen: handle /dev/tcp/local/9876/FOO/other
00-05-09 cssfd: CS_POLL_WRITE implies O_NONBLOCK
00-02-14 cschallenge(): add stat() to verify touch()
00-02-03 features/lib: add sys/types.h to htons etc. header refs

<H4>libpp</H4>

00-06-01 pplex: fix "\\U" and "\\u"
00-05-22 ppsearch: fix uwin #include &lt;C:/foo/bar.h&gt;
00-05-16 probe.win32: update reserved word list
00-05-09 ppcontrol: fix C++ macro &gt;+&gt; invalid fuse
	 ppcontrol: 'macro' expansion only for COMPATIBILITY | TRANSITION
	 c9x: up to date with proposed standard
00-04-01 pp.tab: add allpossible and ALLPOSSIBLE
	 ppmacref: fix ref inside literal catenation
00-02-14 pppopen(): general comments with "bme" (begin middle end) string

<H4>libcdb</H4>

00-02-14 cdbimage: fix record span bug that caused cql regression test failures

<H4>libpz</H4>

00-05-31 pzclose(): check for pz-&gt;io == 0
00-02-14 PZ_DELAY|PZ_HANDLE|PZ_UNKNOWN for 'unknown format' after pzlib() done
</PRE>
<HR>
<P>
June 22, 2000

</TD></TR></TABLE>
</BODY>
</HTML>
